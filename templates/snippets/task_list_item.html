{% load journal_filters %}

{% with task|new_comments_count_for_user:user as new_comments_count %}
<div class="card list-card {% if not task|is_user_acquainted:user %}card-new border-success{% else %}border-dark{% endif %} mb-3">
  <div class="card-header">
    {% if task.is_private %}
      <i class="fa-solid fa-lock me-2"></i>
    {% endif %}
    <i class="fa-solid fa-tag"></i> <span class="text-muted">{{ task.category }}</span>
  </div>
  <div class="card-body">
    <h5 class="card-title">
      <a class="title-link" href="{{ task.get_absolute_url }}">
        {{ task.title }}
      </a>
    </h5>
    <p class="card-text">{{ task.body }}</p>
  </div>
  <div class="card-footer text-muted">
    <i class="fa-regular fa-calendar"></i> {{ task.created }} &middot; <i class="fa-solid fa-user"></i> {{ task.author.short_name }} &middot; <i class="fa-solid fa-comments"></i> {{ task.active_comments.count }}
    {% if new_comments_count %}
      <span class="badge text-bg-success"
            data-bs-toggle="tooltip" data-bs-title="Количество новых комментариев к задаче, с которыми вы еще не ознакомлены"
            data-bs-delay='{"show":1000,"hide":0}'>{{ new_comments_count }}</span>
    {% endif %}<!-- &middot; <i class="fa-solid fa-user-check"></i> {{ task.users_acquainted.count }}--> {% if task.due_date %}&middot; <i class="fa-solid fa-calendar-day"></i> {{ task.due_date }}{% endif %}
  </div>
</div>
{% endwith %}