(function(){"use strict";var e={1427:function(e,t,o){var l=o(9199);function a(e,t,o,a,s,n){const i=(0,l.resolveComponent)("TaskListTable");return(0,l.openBlock)(),(0,l.createBlock)(i,{tasks:s.tasksAll,categories:s.categoriesAll,"default-fetch-options":s.fetchOptions,onFetchOptionsChanged:t[0]||(t[0]=e=>this.fetchOptions=e),onOrderChanged:t[1]||(t[1]=e=>this.orderByFields=e)},null,8,["tasks","categories","default-fetch-options"])}const s=e=>((0,l.pushScopeId)("data-v-3b5f298c"),e=e(),(0,l.popScopeId)(),e),n={class:"alert alert-secondary"},i={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-baseline m-0"},r={class:"btn-toolbar mb-2 mb-md-0"},c=s((()=>(0,l.createElementVNode)("i",{class:"fa-solid fa-gears"},null,-1))),d={key:0,class:"row mb-3 border-top pt-3 mt-3"},m={class:"col-2"},p=s((()=>(0,l.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Фильтры",-1))),h=s((()=>(0,l.createElementVNode)("label",{for:"check-show-active",class:"options-checkbox-label"},"В работе",-1))),u=s((()=>(0,l.createElementVNode)("br",null,null,-1))),b=s((()=>(0,l.createElementVNode)("label",{for:"check-show-private",class:"options-checkbox-label"},"Личные",-1))),f=s((()=>(0,l.createElementVNode)("br",null,null,-1))),k=s((()=>(0,l.createElementVNode)("label",{for:"check-show-completed",class:"options-checkbox-label"},"Завершенные",-1))),g=s((()=>(0,l.createElementVNode)("br",null,null,-1))),v=s((()=>(0,l.createElementVNode)("label",{for:"check-show-favorite-only",class:"options-checkbox-label"},"Только избранные",-1))),w=s((()=>(0,l.createElementVNode)("br",null,null,-1))),V={class:"col-2"},y=s((()=>(0,l.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Упорядочить",-1))),N={class:"col-2"},E=s((()=>(0,l.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Отображение",-1))),O=s((()=>(0,l.createElementVNode)("label",{for:"check-auto-update",class:"options-checkbox-label"},"Автообновление",-1))),C=s((()=>(0,l.createElementVNode)("br",null,null,-1))),x=s((()=>(0,l.createElementVNode)("label",{for:"check-show-category",class:"options-checkbox-label"},"Категории",-1))),S=s((()=>(0,l.createElementVNode)("br",null,null,-1))),B=s((()=>(0,l.createElementVNode)("label",{for:"check-show-comments-count",class:"options-checkbox-label"},"Комментарии",-1))),F=s((()=>(0,l.createElementVNode)("br",null,null,-1))),T=s((()=>(0,l.createElementVNode)("label",{for:"check-show-created-date",class:"options-checkbox-label"},"Дата создания",-1))),D=s((()=>(0,l.createElementVNode)("br",null,null,-1))),_=s((()=>(0,l.createElementVNode)("label",{for:"check-show-completed-date",class:"options-checkbox-label"},"Дата завершения",-1))),I=s((()=>(0,l.createElementVNode)("br",null,null,-1))),A={class:"col-6"},U=s((()=>(0,l.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Категории",-1))),j=["id","value"],M=["for"],J=s((()=>(0,l.createElementVNode)("br",null,null,-1))),L={class:"table table-hover table-tasks text-nowrap"},P=s((()=>(0,l.createElementVNode)("th",{scope:"col",class:"text-center",style:{width:"30px"}},[(0,l.createElementVNode)("i",{class:"fa-regular fa-star"})],-1))),R=s((()=>(0,l.createElementVNode)("th",{scope:"col",class:"text-center",style:{width:"30px"}},[(0,l.createElementVNode)("i",{class:"fa-regular fa-lock"})],-1))),q=s((()=>(0,l.createElementVNode)("th",null," Задача ",-1))),$={key:0,class:"table-column-date text-center"},X={key:1,class:"table-column-date text-center"},Z={key:0,class:"fa-regular fa-star"},K={key:0,class:"fa-regular fa-lock"},z={key:0,class:"fa-solid fa-check-double"},H=["href"],W={key:1,class:"text-muted category-title"},G=s((()=>(0,l.createElementVNode)("i",{class:"fa-solid fa-comments"},null,-1))),Q={key:0},Y={key:2,class:"text-muted category-title"},ee=s((()=>(0,l.createElementVNode)("i",{class:"fa-solid fa-tag"},null,-1))),te={key:0,class:"table-column-date text-center"},oe={class:"text-muted category-title"},le={key:1,class:"table-column-date text-center"},ae={class:"text-muted category-title"};function se(e,t,o,a,s,se){const ne=(0,l.resolveComponent)("OrderBySelector");return(0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createElementVNode)("div",n,[(0,l.createElementVNode)("div",i,[(0,l.createElementVNode)("h4",null," Всего задач: "+(0,l.toDisplayString)(this.tasks.length)+", отображается: "+(0,l.toDisplayString)(se.filteredTasks.length)+". ",1),(0,l.createElementVNode)("div",r,[(0,l.createElementVNode)("button",{class:"btn btn-sm btn-primary",onClick:t[0]||(t[0]=e=>s.viewOptions.showOptions=!s.viewOptions.showOptions)},[c,(0,l.createTextVNode)(" Настройки ")])])]),s.viewOptions.showOptions?((0,l.openBlock)(),(0,l.createElementBlock)("div",d,[(0,l.createElementVNode)("div",m,[p,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>s.tasksFilters.showActive=e),id:"check-show-active"},null,512),[[l.vModelCheckbox,s.tasksFilters.showActive]]),(0,l.createTextVNode)(),h,u,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>s.tasksFilters.showPrivate=e),id:"check-show-private"},null,512),[[l.vModelCheckbox,s.tasksFilters.showPrivate]]),(0,l.createTextVNode)(),b,f,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>s.tasksFilters.showCompleted=e),id:"check-show-completed"},null,512),[[l.vModelCheckbox,s.tasksFilters.showCompleted]]),(0,l.createTextVNode)(),k,g,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>s.tasksFilters.showFavoritesOnly=e),id:"check-show-favorite-only"},null,512),[[l.vModelCheckbox,s.tasksFilters.showFavoritesOnly]]),(0,l.createTextVNode)(),v,w]),(0,l.createElementVNode)("div",V,[y,(0,l.createVNode)(ne,{onOrderChanged:t[5]||(t[5]=e=>this.orderByFields=e)})]),(0,l.createElementVNode)("div",N,[E,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>s.fetchOptions.autoUpdate=e),id:"check-auto-update"},null,512),[[l.vModelCheckbox,s.fetchOptions.autoUpdate]]),(0,l.createTextVNode)(),O,C,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>s.viewOptions.showCategory=e),id:"check-show-category"},null,512),[[l.vModelCheckbox,s.viewOptions.showCategory]]),(0,l.createTextVNode)(),x,S,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>s.viewOptions.showCommentsCount=e),id:"check-show-comments-count"},null,512),[[l.vModelCheckbox,s.viewOptions.showCommentsCount]]),(0,l.createTextVNode)(),B,F,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>s.viewOptions.showCreatedDate=e),id:"check-show-created-date"},null,512),[[l.vModelCheckbox,s.viewOptions.showCreatedDate]]),(0,l.createTextVNode)(),T,D,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=e=>s.viewOptions.showCompletedDate=e),id:"check-show-completed-date"},null,512),[[l.vModelCheckbox,s.viewOptions.showCompletedDate]]),(0,l.createTextVNode)(),_,I]),(0,l.createElementVNode)("div",A,[U,((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(this.categories,(e=>((0,l.openBlock)(),(0,l.createElementBlock)("span",{key:e.id},[(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=e=>s.categoriesVisibleIds=e),id:"category"+e.id,value:e.id},null,8,j),[[l.vModelCheckbox,s.categoriesVisibleIds]]),(0,l.createTextVNode)(),(0,l.createElementVNode)("label",{for:"category"+e.id,class:"options-checkbox-label"},(0,l.toDisplayString)(e.title),9,M),J])))),128)),(0,l.createElementVNode)("button",{onClick:t[12]||(t[12]=e=>s.categoriesVisibleIds=[]),class:"btn btn-sm btn-primary me-1 mt-2"},"Убрать все"),(0,l.createElementVNode)("button",{onClick:t[13]||(t[13]=(...e)=>se.copyAllCategoryIdsToVisible&&se.copyAllCategoryIdsToVisible(...e)),class:"btn btn-sm btn-primary mt-2"},"Показать все")])])):(0,l.createCommentVNode)("",!0)]),(0,l.createElementVNode)("table",L,[(0,l.createElementVNode)("thead",null,[(0,l.createElementVNode)("tr",null,[P,R,q,s.viewOptions.showCreatedDate?((0,l.openBlock)(),(0,l.createElementBlock)("th",$," Создана ")):(0,l.createCommentVNode)("",!0),s.viewOptions.showCompletedDate?((0,l.openBlock)(),(0,l.createElementBlock)("th",X," Завершена ")):(0,l.createCommentVNode)("",!0)])]),(0,l.createElementVNode)("tbody",null,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(se.filteredTasks,(e=>((0,l.openBlock)(),(0,l.createElementBlock)("tr",{key:e.id,class:(0,l.normalizeClass)(e.is_acquainted?"":"table-success")},[(0,l.createElementVNode)("td",null,[e.is_favorite?((0,l.openBlock)(),(0,l.createElementBlock)("i",Z)):(0,l.createCommentVNode)("",!0)]),(0,l.createElementVNode)("td",null,[e.is_private?((0,l.openBlock)(),(0,l.createElementBlock)("i",K)):(0,l.createCommentVNode)("",!0)]),(0,l.createElementVNode)("td",null,[e.is_completed?((0,l.openBlock)(),(0,l.createElementBlock)("i",z)):(0,l.createCommentVNode)("",!0),(0,l.createElementVNode)("a",{href:`/journal/task/${e.id}/`},(0,l.toDisplayString)(e.title),9,H),s.viewOptions.showCommentsCount?((0,l.openBlock)(),(0,l.createElementBlock)("span",W,[G,(0,l.createTextVNode)(" "+(0,l.toDisplayString)(e.comments_count),1),e.new_comments_count?((0,l.openBlock)(),(0,l.createElementBlock)("span",Q," · "+(0,l.toDisplayString)(e.new_comments_count),1)):(0,l.createCommentVNode)("",!0)])):(0,l.createCommentVNode)("",!0),s.viewOptions.showCategory?((0,l.openBlock)(),(0,l.createElementBlock)("span",Y,[ee,(0,l.createTextVNode)(" "+(0,l.toDisplayString)(e.category_title),1)])):(0,l.createCommentVNode)("",!0)]),s.viewOptions.showCreatedDate?((0,l.openBlock)(),(0,l.createElementBlock)("td",te,[(0,l.createElementVNode)("span",oe,(0,l.toDisplayString)(se.formatDateTime(e.created)),1)])):(0,l.createCommentVNode)("",!0),s.viewOptions.showCompletedDate?((0,l.openBlock)(),(0,l.createElementBlock)("td",le,[(0,l.createElementVNode)("span",ae,(0,l.toDisplayString)(e.is_completed?se.formatDateTime(e.completed):""),1)])):(0,l.createCommentVNode)("",!0)],2)))),128))])])],64)}o(7658);const ne=e=>((0,l.pushScopeId)("data-v-6d0ed4be"),e=e(),(0,l.popScopeId)(),e),ie=ne((()=>(0,l.createElementVNode)("h6",{class:"options-title"},"Сортировать по:",-1))),re=["onClick"],ce=ne((()=>(0,l.createElementVNode)("h6",{class:"options-title"},"Доступные поля:",-1)));function de(e,t,o,a,s,n){const i=(0,l.resolveComponent)("draggable");return(0,l.openBlock)(),(0,l.createElementBlock)("div",null,[(0,l.createElementVNode)("div",null,[ie,(0,l.createVNode)(i,{list:s.fieldsSelected,itemKey:"id",group:"fields",class:"drop-area"},{item:(0,l.withCtx)((({element:e})=>[(0,l.createElementVNode)("div",null,[(0,l.createTextVNode)((0,l.toDisplayString)(e.name)+" ",1),(0,l.createElementVNode)("button",{class:"button-ascending",onClick:t=>e.ascending=!e.ascending},(0,l.toDisplayString)(e.ascending?"▲":"▼"),9,re)])])),_:1},8,["list"])]),(0,l.createElementVNode)("div",null,[ce,(0,l.createVNode)(i,{list:s.fieldsAvailable,itemKey:"id",group:"fields",class:"drop-area"},{item:(0,l.withCtx)((({element:e})=>[(0,l.createElementVNode)("div",null,(0,l.toDisplayString)(e.name),1)])),_:1},8,["list"])])])}var me=o(6983),pe=o.n(me),he={components:{draggable:pe()},props:{orderBy:Array},emits:["orderChanged"],data(){return{fieldsSelected:[{name:"Новое",id:1,sortField:"is_acquainted",ascending:!0},{name:"Избранное",id:2,sortField:"is_favorite",ascending:!1},{name:"В работе",id:3,sortField:"is_completed",ascending:!0}],fieldsAvailable:[{name:"Дата создания",id:4,sortField:"created",ascending:!0},{name:"Дата завершения",id:5,sortField:"completed",ascending:!1},{name:"Личное",id:6,sortField:"is_private",ascending:!0}]}},watch:{fieldsSelected:{handler(e){localStorage.setItem("fieldsSelected",JSON.stringify(e)),this.$emit("orderChanged",this.orderByFields)},deep:!0},fieldsAvailable:{handler(e){localStorage.setItem("fieldsAvailable",JSON.stringify(e))},deep:!0}},computed:{orderByFields(){let e=[];return this.fieldsSelected.forEach((t=>{e.push(t.ascending?t.sortField:"-"+t.sortField)})),e}},mounted(){let e=JSON.parse(localStorage.getItem("fieldsSelected"));e&&(this.fieldsSelected=e);let t=JSON.parse(localStorage.getItem("fieldsAvailable"));t&&(this.fieldsAvailable=t)}},ue=o(89);const be=(0,ue.Z)(he,[["render",de],["__scopeId","data-v-6d0ed4be"]]);var fe=be,ke={name:"TaskListTable",components:{OrderBySelector:fe},props:{tasks:Array,categories:Array,defaultFetchOptions:Object},emits:["fetchOptionsChanged","orderChanged"],data(){return{categoriesVisibleIds:[],orderByFields:[],tasksFilters:{showActive:!0,showCompleted:!1,showPrivate:!0,showFavoritesOnly:!1},viewOptions:{showOptions:!0,showCategory:!1,showCommentsCount:!0,showCreatedDate:!1,showCompletedDate:!1},fetchOptions:this.defaultFetchOptions}},watch:{categoriesVisibleIds:{handler(e){localStorage.setItem("categoriesVisibleIds",JSON.stringify(e))},deep:!0},orderByFields:{handler(){this.$emit("orderChanged",this.orderByFields)},deep:!0},viewOptions:{handler(e){localStorage.setItem("viewOptions",JSON.stringify(e))},deep:!0},tasksFilters:{handler(e){localStorage.setItem("tasksFilters",JSON.stringify(e))},deep:!0},fetchOptions:{handler(e){this.$emit("fetchOptionsChanged",e)},deep:!0}},computed:{filteredTasks(){let e=this.tasks;return this.tasksFilters.showCompleted||(e=e.filter((e=>!e.is_completed))),this.tasksFilters.showActive||(e=e.filter((e=>e.is_completed))),this.tasksFilters.showFavoritesOnly&&(e=e.filter((e=>e.is_favorite))),this.tasksFilters.showPrivate||(e=e.filter((e=>!e.is_private))),e=e.filter((e=>this.categoriesVisibleIds.includes(e.category))),e}},methods:{copyAllCategoryIdsToVisible(){for(let e=0;e<this.categories.length;e++)this.categoriesVisibleIds.push(this.categories[e].id)},formatDateTime(e){let t=new Date(e);return t.toLocaleDateString("ru-RU")+" "+t.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}},mounted(){let e=JSON.parse(localStorage.getItem("viewOptions"));e&&(this.viewOptions=e);let t=JSON.parse(localStorage.getItem("tasksFilters"));t&&(this.tasksFilters=t);let o=JSON.parse(localStorage.getItem("categoriesVisibleIds"));o?this.categoriesVisibleIds=o:this.copyAllCategoryIdsToVisible()}};const ge=(0,ue.Z)(ke,[["render",se],["__scopeId","data-v-3b5f298c"]]);var ve=ge,we={name:"App",components:{TaskListTable:ve},data(){return{tasksAll:[],categoriesAll:[],orderByFields:[],fetchOptions:{autoUpdate:!0,pollDataTimeout:5e3},polling:null}},watch:{fetchOptions:{handler(e){localStorage.setItem("fetchOptions",JSON.stringify(e))},deep:!0},orderByFields:{handler(){this.fetchAllTasks()},deep:!0}},methods:{fetchAllCategories(){const e=window.location.origin+"/journal/tasks/api/v1/category_list/";return window.axios.get(e,{params:{}}).then((e=>(this.categoriesAll=e.data,e.data))).catch((function(e){throw console.log("Axios.get error:",e),e}))},fetchAllTasks(){const e=window.location.origin+"/journal/tasks/api/v1/task_list/";let t={orderByFields:this.orderByFields.toString()};return window.axios.get(e,{params:t}).then((e=>(this.tasksAll=e.data,e.data))).catch((function(e){throw console.log("Axios.get error:",e),e}))},pollData(){this.polling=setInterval((()=>{this.fetchOptions.autoUpdate&&this.fetchAllTasks()}),this.fetchOptions.pollDataTimeout)}},created(){this.fetchAllCategories(),this.fetchAllTasks(),this.pollData()},beforeUnmount(){clearInterval(this.polling)},mounted(){let e=JSON.parse(localStorage.getItem("fetchOptions"));e&&(this.fetchOptions=e)}};const Ve=(0,ue.Z)(we,[["render",a]]);var ye=Ve;window.axios=o(7218),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";let Ne=document.getElementsByName("csrfmiddlewaretoken");Ne?window.axios.defaults.headers.common["X-CSRFToken"]=Ne[0].value:console.error("CSRF token not found: https://docs.djangoproject.com/en/3.0/ref/csrf/#ajax"),(0,l.createApp)(ye).mount("#app")}},t={};function o(l){var a=t[l];if(void 0!==a)return a.exports;var s=t[l]={exports:{}};return e[l].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,l,a,s){if(!l){var n=1/0;for(d=0;d<e.length;d++){l=e[d][0],a=e[d][1],s=e[d][2];for(var i=!0,r=0;r<l.length;r++)(!1&s||n>=s)&&Object.keys(o.O).every((function(e){return o.O[e](l[r])}))?l.splice(r--,1):(i=!1,s<n&&(n=s));if(i){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[l,a,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,l){var a,s,n=l[0],i=l[1],r=l[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(r)var d=r(o)}for(t&&t(l);c<n.length;c++)s=n[c],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(d)},l=self["webpackChunkvue_tasks_table_view"]=self["webpackChunkvue_tasks_table_view"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=o.O(void 0,[998],(function(){return o(1427)}));l=o.O(l)})();
//# sourceMappingURL=app.js.map