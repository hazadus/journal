(function(){"use strict";var e={2727:function(e,t,o){var a=o(9199);const l={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-baseline pt-3 pb-2 mb-3 border-bottom"},s=(0,a.createElementVNode)("h1",{class:"h2"}," Задачи: табличный вид (Vue) ",-1),c={class:"btn-toolbar mb-2 mb-md-0"},n=(0,a.createElementVNode)("i",{class:"fa-solid fa-columns"},null,-1),i=(0,a.createElementVNode)("i",{class:"fa-solid fa-table"},null,-1),r=(0,a.createElementVNode)("i",{class:"fa-solid fa-gears"},null,-1),d=(0,a.createElementVNode)("a",{class:"btn btn-sm btn-success",href:"/journal/task/create/"},[(0,a.createElementVNode)("i",{class:"fa-solid fa-file-circle-plus"}),(0,a.createTextVNode)(" Добавить задачу ")],-1),m={key:0,class:"d-flex align-items-center"},p=(0,a.createElementVNode)("div",{class:"spinner-border text-primary me-3",role:"status"},[(0,a.createElementVNode)("span",{class:"visually-hidden"},"Loading...")],-1),u=(0,a.createElementVNode)("div",null," Идёт загрузка — пожалуйста, подождите! ",-1),h=[p,u];function k(e,t,o,p,u,k){const f=(0,a.resolveComponent)("TaskListTable"),v=(0,a.resolveComponent)("TaskListSidebar");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createElementVNode)("div",l,[s,(0,a.createElementVNode)("div",c,[(0,a.createElementVNode)("button",{onClick:t[0]||(t[0]=e=>u.viewOptions.isTableView=!u.viewOptions.isTableView),class:"btn btn-sm btn-warning me-1"},[u.viewOptions.isTableView?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[n,(0,a.createTextVNode)(" Колонки ")],64)):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[i,(0,a.createTextVNode)(" Таблица ")],64))]),(0,a.createElementVNode)("button",{class:"btn btn-sm btn-primary me-1",onClick:t[1]||(t[1]=e=>u.viewOptions.showOptions=!u.viewOptions.showOptions)},[r,(0,a.createTextVNode)(" Настройки ")]),d])]),u.tasksAll.length&&u.categoriesAll.length?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[u.viewOptions.isTableView?((0,a.openBlock)(),(0,a.createBlock)(f,{key:0,tasks:u.tasksAll,"filtered-tasks":k.filteredTasks,categories:u.categoriesAll},null,8,["tasks","filtered-tasks","categories"])):((0,a.openBlock)(),(0,a.createBlock)(v,{key:1,tasks:u.tasksAll,"filtered-tasks":k.filteredTasks,categories:u.categoriesAll},null,8,["tasks","filtered-tasks","categories"]))],64)):((0,a.openBlock)(),(0,a.createElementBlock)("div",m,h))],64)}const f=e=>((0,a.pushScopeId)("data-v-2181c95c"),e=e(),(0,a.popScopeId)(),e),v={class:"alert alert-secondary"},g={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-baseline m-0"},V={class:"table-tasks-wrapper"},b={class:"table table-hover table-tasks text-nowrap"},w=f((()=>(0,a.createElementVNode)("th",{scope:"col",class:"text-center",style:{width:"30px"}},[(0,a.createElementVNode)("i",{class:"fa-regular fa-star"})],-1))),N=f((()=>(0,a.createElementVNode)("th",{scope:"col",class:"text-center",style:{width:"30px"}},[(0,a.createElementVNode)("i",{class:"fa-regular fa-lock"})],-1))),E=f((()=>(0,a.createElementVNode)("th",null," Задача ",-1))),y={key:0,class:"table-column-date text-center"},x={key:1,class:"table-column-date text-center"},C={class:"text-muted"},B={key:0,class:"fa-regular fa-lock"},T={key:0,class:"task-completed-mark"},_=f((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-check"},null,-1))),O=[_],S=["href"],I={key:1,class:"text-muted category-title"},D=f((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-comments"},null,-1))),F={key:0},A={key:2,class:"ms-1"},L=["href"],U=f((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-paperclip"},null,-1))),j=[U],M={key:3,class:"text-muted category-title"},P=f((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-tag"},null,-1))),z={key:0,class:"table-column-date text-center"},J={class:"text-muted category-title"},q={key:1,class:"table-column-date text-center"},R={class:"text-muted category-title"};function H(e,t,o,l,s,c){const n=(0,a.resolveComponent)("OptionsPanel"),i=(0,a.resolveComponent)("TaskFavoriteButton");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createElementVNode)("div",v,[(0,a.createElementVNode)("div",g,[(0,a.createElementVNode)("h4",null," Всего задач: "+(0,a.toDisplayString)(this.tasks.length)+", отображается: "+(0,a.toDisplayString)(o.filteredTasks.length)+". ",1)]),s.viewOptions.showOptions?((0,a.openBlock)(),(0,a.createBlock)(n,{key:0,categories:o.categories},null,8,["categories"])):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("div",V,[(0,a.createElementVNode)("table",b,[(0,a.createElementVNode)("thead",null,[(0,a.createElementVNode)("tr",null,[w,N,E,s.viewOptions.showCreatedDate?((0,a.openBlock)(),(0,a.createElementBlock)("th",y," Создана ")):(0,a.createCommentVNode)("",!0),s.viewOptions.showCompletedDate?((0,a.openBlock)(),(0,a.createElementBlock)("th",x," Завершена ")):(0,a.createCommentVNode)("",!0)])]),(0,a.createElementVNode)("tbody",null,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(o.filteredTasks,(e=>((0,a.openBlock)(),(0,a.createElementBlock)("tr",{key:e.id,class:(0,a.normalizeClass)(e.is_acquainted?"":"table-success")},[(0,a.createElementVNode)("td",null,[(0,a.createVNode)(i,{task:e},null,8,["task"])]),(0,a.createElementVNode)("td",C,[e.is_private?((0,a.openBlock)(),(0,a.createElementBlock)("i",B)):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("td",null,[e.is_completed?((0,a.openBlock)(),(0,a.createElementBlock)("span",T,O)):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("a",{href:`/journal/task/${e.id}/`,class:"task-title-link"},(0,a.toDisplayString)(e.title),9,S),s.viewOptions.showCommentsCount?((0,a.openBlock)(),(0,a.createElementBlock)("span",I,[D,(0,a.createTextVNode)(" "+(0,a.toDisplayString)(e.comments_count),1),e.new_comments_count?((0,a.openBlock)(),(0,a.createElementBlock)("span",F," · "+(0,a.toDisplayString)(e.new_comments_count),1)):(0,a.createCommentVNode)("",!0)])):(0,a.createCommentVNode)("",!0),e.attachment?((0,a.openBlock)(),(0,a.createElementBlock)("span",A,[(0,a.createElementVNode)("a",{href:e.attachment,class:"text-muted"},j,8,L)])):(0,a.createCommentVNode)("",!0),s.viewOptions.showCategory?((0,a.openBlock)(),(0,a.createElementBlock)("span",M,[P,(0,a.createTextVNode)(" "+(0,a.toDisplayString)(e.category_title),1)])):(0,a.createCommentVNode)("",!0)]),s.viewOptions.showCreatedDate?((0,a.openBlock)(),(0,a.createElementBlock)("td",z,[(0,a.createElementVNode)("span",J,(0,a.toDisplayString)(c.useFormatDateTime(e.created)),1)])):(0,a.createCommentVNode)("",!0),s.viewOptions.showCompletedDate?((0,a.openBlock)(),(0,a.createElementBlock)("td",q,[(0,a.createElementVNode)("span",R,(0,a.toDisplayString)(e.is_completed?c.useFormatDateTime(e.completed):""),1)])):(0,a.createCommentVNode)("",!0)],2)))),128))])])])],64)}const Z=e=>((0,a.pushScopeId)("data-v-f4e38a04"),e=e(),(0,a.popScopeId)(),e),$={class:"row mb-3 border-top pt-3 mt-3"},X={class:"col-6 col-lg-2"},K=Z((()=>(0,a.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Фильтры",-1))),W=Z((()=>(0,a.createElementVNode)("label",{for:"check-show-active",class:"options-checkbox-label"},"В работе",-1))),G=Z((()=>(0,a.createElementVNode)("br",null,null,-1))),Q=Z((()=>(0,a.createElementVNode)("label",{for:"check-show-private",class:"options-checkbox-label"},"Личные",-1))),Y=Z((()=>(0,a.createElementVNode)("br",null,null,-1))),ee=Z((()=>(0,a.createElementVNode)("label",{for:"check-show-completed",class:"options-checkbox-label"},"Завершенные",-1))),te=Z((()=>(0,a.createElementVNode)("br",null,null,-1))),oe=Z((()=>(0,a.createElementVNode)("label",{for:"check-show-favorite-only",class:"options-checkbox-label"},[(0,a.createTextVNode)("Только "),(0,a.createElementVNode)("i",{class:"fa-regular fa-star"})],-1))),ae=Z((()=>(0,a.createElementVNode)("br",null,null,-1))),le={class:"col-6 col-lg-2"},se=Z((()=>(0,a.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Упорядочить",-1))),ce={class:"col-6 col-lg-2"},ne=Z((()=>(0,a.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Отображение",-1))),ie={class:"options-checkbox-block"},re=Z((()=>(0,a.createElementVNode)("label",{for:"check-auto-update",class:"options-checkbox-label"},"Автообновление",-1))),de={class:"options-checkbox-block"},me=Z((()=>(0,a.createElementVNode)("label",{for:"check-show-category",class:"options-checkbox-label"},"Категории",-1))),pe={class:"options-checkbox-block"},ue=Z((()=>(0,a.createElementVNode)("label",{for:"check-show-comments-count",class:"options-checkbox-label"},"Комментарии",-1))),he={class:"options-checkbox-block"},ke=Z((()=>(0,a.createElementVNode)("label",{for:"check-show-created-date",class:"options-checkbox-label"},"Дата создания",-1))),fe={class:"options-checkbox-block"},ve=Z((()=>(0,a.createElementVNode)("label",{for:"check-show-completed-date",class:"options-checkbox-label"},"Дата завершения",-1))),ge={class:"col-6 col-lg-6"},Ve=Z((()=>(0,a.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Категории",-1))),be=["id","value"],we=["for","onClick"],Ne=Z((()=>(0,a.createElementVNode)("br",null,null,-1))),Ee=Z((()=>(0,a.createElementVNode)("br",null,null,-1)));function ye(e,t,o,l,s,c){const n=(0,a.resolveComponent)("OrderBySelector");return(0,a.openBlock)(),(0,a.createElementBlock)("div",$,[(0,a.createElementVNode)("div",X,[K,(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>s.taskFilters.showActive=e),id:"check-show-active"},null,512),[[a.vModelCheckbox,s.taskFilters.showActive]]),(0,a.createTextVNode)(),W,G,(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>s.taskFilters.showPrivate=e),id:"check-show-private"},null,512),[[a.vModelCheckbox,s.taskFilters.showPrivate]]),(0,a.createTextVNode)(),Q,Y,(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>s.taskFilters.showCompleted=e),id:"check-show-completed"},null,512),[[a.vModelCheckbox,s.taskFilters.showCompleted]]),(0,a.createTextVNode)(),ee,te,(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>s.taskFilters.showFavoritesOnly=e),id:"check-show-favorite-only"},null,512),[[a.vModelCheckbox,s.taskFilters.showFavoritesOnly]]),(0,a.createTextVNode)(),oe,ae]),(0,a.createElementVNode)("div",le,[se,(0,a.createVNode)(n)]),(0,a.createElementVNode)("div",ce,[ne,(0,a.createElementVNode)("span",ie,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>s.fetchOptions.autoUpdate=e),id:"check-auto-update"},null,512),[[a.vModelCheckbox,s.fetchOptions.autoUpdate]]),(0,a.createTextVNode)(),re]),(0,a.createElementVNode)("span",de,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=e=>s.viewOptions.showCategory=e),id:"check-show-category"},null,512),[[a.vModelCheckbox,s.viewOptions.showCategory]]),(0,a.createTextVNode)(),me]),(0,a.createElementVNode)("span",pe,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>s.viewOptions.showCommentsCount=e),id:"check-show-comments-count"},null,512),[[a.vModelCheckbox,s.viewOptions.showCommentsCount]]),(0,a.createTextVNode)(),ue]),(0,a.createElementVNode)("span",he,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>s.viewOptions.showCreatedDate=e),id:"check-show-created-date"},null,512),[[a.vModelCheckbox,s.viewOptions.showCreatedDate]]),(0,a.createTextVNode)(),ke]),(0,a.createElementVNode)("span",fe,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>s.viewOptions.showCompletedDate=e),id:"check-show-completed-date"},null,512),[[a.vModelCheckbox,s.viewOptions.showCompletedDate]]),(0,a.createTextVNode)(),ve])]),(0,a.createElementVNode)("div",ge,[Ve,((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(this.categories,(e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e.id,class:"options-checkbox-block"},[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>s.viewOptions.categoriesVisibleIds=e),id:"category"+e.id,value:e.id},null,8,be),[[a.vModelCheckbox,s.viewOptions.categoriesVisibleIds]]),(0,a.createTextVNode)(),(0,a.createElementVNode)("label",{for:"category"+e.id,class:"options-checkbox-label",onClick:(0,a.withModifiers)((t=>s.viewOptions.categoriesVisibleIds=[e.id]),["alt","prevent"])},(0,a.toDisplayString)(e.title),9,we),Ne])))),128)),(0,a.createElementVNode)("button",{onClick:t[10]||(t[10]=e=>s.viewOptions.categoriesVisibleIds=[]),class:"btn btn-sm btn-primary me-1 mt-2"},"Убрать все"),(0,a.createElementVNode)("button",{onClick:t[11]||(t[11]=e=>s.viewOptions.copyAllCategoryIdsToVisible(o.categories)),class:"btn btn-sm btn-primary mt-2"},"Показать все"),Ee])])}const xe=e=>((0,a.pushScopeId)("data-v-4460c7de"),e=e(),(0,a.popScopeId)(),e),Ce=xe((()=>(0,a.createElementVNode)("h6",{class:"options-title"},"Сортировать по:",-1))),Be={class:"drop-item"},Te=["onClick"],_e=xe((()=>(0,a.createElementVNode)("h6",{class:"options-title"},"Доступные поля:",-1))),Oe={class:"drop-item"};function Se(e,t,o,l,s,c){const n=(0,a.resolveComponent)("draggable");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createElementVNode)("div",null,[Ce,(0,a.createVNode)(n,{list:s.fieldsSelected,itemKey:"id",group:"fields",class:"drop-area"},{item:(0,a.withCtx)((({element:e})=>[(0,a.createElementVNode)("div",Be,[(0,a.createTextVNode)((0,a.toDisplayString)(e.name)+" ",1),(0,a.createElementVNode)("button",{class:"button-ascending",onClick:t=>e.ascending=!e.ascending},(0,a.toDisplayString)(e.ascending?"▲":"▼"),9,Te)])])),_:1},8,["list"])]),(0,a.createElementVNode)("div",null,[_e,(0,a.createVNode)(n,{list:s.fieldsAvailable,itemKey:"id",group:"fields",class:"drop-area"},{item:(0,a.withCtx)((({element:e})=>[(0,a.createElementVNode)("div",Oe,(0,a.toDisplayString)(e.name),1)])),_:1},8,["list"])])])}o(7658);var Ie=o(6983),De=o.n(Ie);const Fe=(0,a.reactive)({autoUpdate:!0,pollDataTimeout:12e3,orderByFields:[],set(e){this.autoUpdate=e.autoUpdate,this.pollDataTimeout=e.pollDataTimeout,this.orderByFields=e.orderByFields}});var Ae={components:{draggable:De()},props:{},data(){return{fetchOptions:Fe,fieldsSelected:[{name:"Новое",id:1,sortField:"is_acquainted",ascending:!0},{name:"Избранное",id:2,sortField:"is_favorite",ascending:!1},{name:"В работе",id:3,sortField:"is_completed",ascending:!0},{name:"Завершено",id:4,sortField:"completed",ascending:!1}],fieldsAvailable:[{name:"Создано",id:5,sortField:"created",ascending:!0},{name:"Личное",id:6,sortField:"is_private",ascending:!0}]}},watch:{fieldsSelected:{handler(e){localStorage.setItem("fieldsSelected",JSON.stringify(e)),Fe.orderByFields=this.orderByFields},deep:!0},fieldsAvailable:{handler(e){localStorage.setItem("fieldsAvailable",JSON.stringify(e))},deep:!0}},computed:{orderByFields(){let e=[];return this.fieldsSelected.forEach((t=>{e.push(t.ascending?t.sortField:"-"+t.sortField)})),e}},mounted(){let e=JSON.parse(localStorage.getItem("fieldsSelected"));e&&(this.fieldsSelected=e);let t=JSON.parse(localStorage.getItem("fieldsAvailable"));t&&(this.fieldsAvailable=t)}},Le=o(89);const Ue=(0,Le.Z)(Ae,[["render",Se],["__scopeId","data-v-4460c7de"]]);var je=Ue;const Me=(0,a.reactive)({showActive:!0,showCompleted:!1,showPrivate:!0,showFavoritesOnly:!1,set(e){this.showActive=e.showActive,this.showCompleted=e.showCompleted,this.showPrivate=e.showPrivate,this.showFavoritesOnly=e.showFavoritesOnly}}),Pe=(0,a.reactive)({isTableView:!0,showOptions:!0,showCategory:!1,showCommentsCount:!0,showCreatedDate:!1,showCompletedDate:!1,categoriesVisibleIds:null,set(e){this.isTableView=e.isTableView,this.showOptions=e.showOptions,this.showCategory=e.showCategory,this.showCommentsCount=e.showCommentsCount,this.showCreatedDate=e.showCreatedDate,this.showCompletedDate=e.showCompletedDate,this.categoriesVisibleIds=e.categoriesVisibleIds},copyAllCategoryIdsToVisible(e){this.categoriesVisibleIds=[];for(let t=0;t<e.length;t++)this.categoriesVisibleIds.push(e[t].id)}});var ze={name:"OptionsPanel",components:{OrderBySelector:je},props:{categories:Array},data(){return{fetchOptions:Fe,taskFilters:Me,viewOptions:Pe}}};const Je=(0,Le.Z)(ze,[["render",ye],["__scopeId","data-v-f4e38a04"]]);var qe=Je;const Re=e=>((0,a.pushScopeId)("data-v-7158f29c"),e=e(),(0,a.popScopeId)(),e),He=Re((()=>(0,a.createElementVNode)("i",{class:"fa-regular fa-star"},null,-1))),Ze=[He];function $e(e,t,o,l,s,c){return(0,a.openBlock)(),(0,a.createElementBlock)("button",{class:(0,a.normalizeClass)(["favorite-button",o.task.is_favorite?"is-favorite":""]),onClick:t[0]||(t[0]=(0,a.withModifiers)((e=>c.onClick(o.task)),["stop"]))},Ze,2)}var Xe={name:"TaskFavoriteButton",props:{task:Object},methods:{onClick(e){alert(e.title)}}};const Ke=(0,Le.Z)(Xe,[["render",$e],["__scopeId","data-v-7158f29c"]]);var We=Ke;function Ge(e){let t=new Date(e);return t.toLocaleDateString("ru-RU")+" "+t.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}function Qe(e){return e.author_avatar_url?"/media/"+e.author_avatar_url:"/static/images/default_profile_pic.png"}function Ye(e){return`${e.author_last_name} ${e.author_first_name.slice(0,1)}.${e.author_second_name.slice(0,1)}.`}var et={name:"TaskListTable",components:{OptionsPanel:qe,TaskFavoriteButton:We},props:{tasks:Array,filteredTasks:Array,categories:Array},data(){return{viewOptions:Pe}},methods:{useFormatDateTime:Ge}};const tt=(0,Le.Z)(et,[["render",H],["__scopeId","data-v-2181c95c"]]);var ot=tt;const at=e=>((0,a.pushScopeId)("data-v-0af180cc"),e=e(),(0,a.popScopeId)(),e),lt={class:"component"},st={class:"tasks"},ct={class:"d-flex align-items-center flex-shrink-0 p-3 link-dark text-decoration-none border-bottom"},nt={class:"",style:{"flex-grow":"1"}},it={class:"task-list list-group list-group-flush"},rt=["onClick"],dt={class:"d-flex w-100 align-items-center justify-content-between"},mt={key:0,class:"task-completed-mark"},pt=at((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-check"},null,-1))),ut=[pt],ht={key:0,class:"text-muted"},kt=at((()=>(0,a.createElementVNode)("i",{class:"fa-regular fa-lock"},null,-1))),ft=[kt],vt={class:"task-list-item-info mb-1 small"},gt={key:0,class:"task-list-item-info-comment-count"},Vt=at((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-comments"},null,-1))),bt=at((()=>(0,a.createElementVNode)("i",{class:"fa-regular fa-tag"},null,-1))),wt={key:0,class:"alert alert-secondary flex-grow-1 m-1"},Nt={key:1,class:"task-detail"},Et={key:0},yt={class:"card-header text-muted"},xt={class:"d-flex flex-wrap flex-md-nowrap align-items-center"},Ct={class:"flex-grow-1"},Bt={key:0,class:"fa-solid fa-lock me-1"},Tt=at((()=>(0,a.createElementVNode)("i",{class:"fa-regular fa-calendar"},null,-1))),_t=at((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-user"},null,-1))),Ot=at((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-calendar-check"},null,-1))),St=["href"],It=at((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-arrow-up-right-from-square"},null,-1))),Dt=[It],Ft={class:"card-body task-card-body"},At=["innerHTML"],Lt={key:0,class:"mt-3"},Ut=at((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-paperclip"},null,-1))),jt=["href"],Mt={key:0,class:"timeline"},Pt=at((()=>(0,a.createElementVNode)("div",{class:"timeline__line"},null,-1))),zt={class:"timeline__items"},Jt={class:"timeline__top mb-2"},qt=at((()=>(0,a.createElementVNode)("div",{class:"timeline__circle text-center"},[(0,a.createElementVNode)("i",{class:"fa-solid fa-comment"})],-1))),Rt=["id"],Ht={class:"timeline__desc_avatar"},Zt={class:"d-flex"},$t={class:"timeline__desc_avatar__avatar mt-3 me-2"},Xt=["src","alt"],Kt={class:"card-header d-flex text-muted"},Wt={class:"flex-grow-1"},Gt=at((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-user"},null,-1))),Qt=["id"],Yt=["innerHTML"],eo={key:1,class:"alert alert-success"},to=at((()=>(0,a.createElementVNode)("i",{class:"fa-solid fa-file-circle-check"},null,-1)));function oo(e,t,o,l,s,c){const n=(0,a.resolveComponent)("TaskFavoriteButton"),i=(0,a.resolveComponent)("OptionsPanel");return(0,a.openBlock)(),(0,a.createElementBlock)("div",lt,[(0,a.createElementVNode)("div",st,[(0,a.createElementVNode)("div",ct,[(0,a.createElementVNode)("div",nt," Задач: "+(0,a.toDisplayString)(o.filteredTasks.length)+" / "+(0,a.toDisplayString)(o.tasks.length),1)]),(0,a.createElementVNode)("div",it,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(this.filteredTasks,(e=>((0,a.openBlock)(),(0,a.createElementBlock)("a",{key:e.id,href:"#",onClick:t=>this.selectedItem=e,class:(0,a.normalizeClass)(["task-list-item list-group-item list-group-item-action py-3 lh-sm",{active:c.isTaskListItemActive(e),"bg-success-subtle":c.isTaskListItemBgSuccessClass(e)}])},[(0,a.createElementVNode)("div",dt,[(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["task-list-item-title flex-grow-1",e.is_acquainted?"":"task-list-item-title-new"])},[e.is_completed?((0,a.openBlock)(),(0,a.createElementBlock)("span",mt,ut)):(0,a.createCommentVNode)("",!0),(0,a.createTextVNode)(" "+(0,a.toDisplayString)(c.sanitize(e.title)),1)],2),(0,a.createVNode)(n,{task:e},null,8,["task"]),e.is_private?((0,a.openBlock)(),(0,a.createElementBlock)("span",ht,ft)):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("div",vt,[s.viewOptions.showCommentsCount?((0,a.openBlock)(),(0,a.createElementBlock)("span",gt,[Vt,(0,a.createTextVNode)(" "+(0,a.toDisplayString)(e.comments_count),1),e.new_comments_count?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[(0,a.createTextVNode)(" · "+(0,a.toDisplayString)(e.new_comments_count),1)],64)):(0,a.createCommentVNode)("",!0)])):(0,a.createCommentVNode)("",!0),s.viewOptions.showCategory?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[bt,(0,a.createTextVNode)(" "+(0,a.toDisplayString)(e.category_title),1)],64)):(0,a.createCommentVNode)("",!0)])],10,rt)))),128))])]),s.viewOptions.showOptions?((0,a.openBlock)(),(0,a.createElementBlock)("div",wt,[(0,a.createVNode)(i,{categories:o.categories},null,8,["categories"])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Nt,[s.selectedItem?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[s.detailItem?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(c.sanitize(s.detailItem.title)),1),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["card mb-2",s.detailItem.is_acquainted?"":"card-new border-success"])},[(0,a.createElementVNode)("div",yt,[(0,a.createElementVNode)("div",xt,[(0,a.createElementVNode)("div",Ct,[(0,a.createVNode)(n,{task:s.detailItem,style:{margin:"0 5px 0 0"}},null,8,["task"]),s.detailItem.is_private?((0,a.openBlock)(),(0,a.createElementBlock)("i",Bt)):(0,a.createCommentVNode)("",!0),Tt,(0,a.createTextVNode)(" "+(0,a.toDisplayString)(c.useFormatDateTime(s.detailItem.created))+" · ",1),_t,(0,a.createTextVNode)(" "+(0,a.toDisplayString)(c.useAuthorShortName(s.detailItem))+" ",1),s.detailItem.is_completed?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createTextVNode)(" · "),Ot,(0,a.createTextVNode)(" "+(0,a.toDisplayString)(c.useFormatDateTime(s.detailItem.completed)),1)],64)):(0,a.createCommentVNode)("",!0),(0,a.createTextVNode)(" · "),(0,a.createElementVNode)("a",{class:"text-muted",href:`/journal/task/${s.detailItem.id}/`,target:"_blank"},Dt,8,St)])])]),(0,a.createElementVNode)("div",Ft,[(0,a.createElementVNode)("span",{innerHTML:c.markdownToHtml(s.detailItem.body)},null,8,At),s.detailItem.attachment?((0,a.openBlock)(),(0,a.createElementBlock)("p",Lt,[Ut,(0,a.createTextVNode)(" Файл: "),(0,a.createElementVNode)("a",{href:s.detailItem.attachment},(0,a.toDisplayString)(decodeURI(s.detailItem.attachment)),9,jt)])):(0,a.createCommentVNode)("",!0)])],2),s.comments?((0,a.openBlock)(),(0,a.createElementBlock)("div",Mt,[Pt,(0,a.createElementVNode)("div",zt,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(s.comments,(e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:"timeline__item mb-3"},[(0,a.createElementVNode)("div",Jt,[qt,(0,a.createElementVNode)("div",{class:"timeline__title",id:"comment-"+e.id}," Добавлен комментарий: ",8,Rt)]),(0,a.createElementVNode)("div",Ht,[(0,a.createElementVNode)("div",Zt,[(0,a.createElementVNode)("div",$t,[(0,a.createElementVNode)("img",{class:"rounded-circle",src:c.useAuthorAvatarURL(e),alt:"Фото "+c.useAuthorShortName(e),width:"48",height:"48"},null,8,Xt)]),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["card flex-grow-1",e.is_acquainted?"bubble":"card-new border-success bubble-new"])},[(0,a.createElementVNode)("div",Kt,[(0,a.createElementVNode)("div",Wt,[Gt,(0,a.createTextVNode)(" "+(0,a.toDisplayString)(c.useAuthorShortName(e))+", "+(0,a.toDisplayString)(c.useFormatDateTime(e.created)),1)])]),(0,a.createElementVNode)("div",{class:"card-body",id:"comment-body-"+e.id},[(0,a.createElementVNode)("span",{innerHTML:c.markdownToHtml(e.body)},null,8,Yt)],8,Qt)],2)])])])))),128))])])):(0,a.createCommentVNode)("",!0),s.detailItem.is_completed?((0,a.openBlock)(),(0,a.createElementBlock)("div",eo,[to,(0,a.createTextVNode)(" Задача завершена. ")])):(0,a.createCommentVNode)("",!0)],64)):(0,a.createCommentVNode)("",!0)],64)):((0,a.openBlock)(),(0,a.createElementBlock)("span",Et," Выберите задачу слева "))]))])}var ao=o(5068),lo=o(3617);ao.TU.setOptions({breaks:!0});var so={name:"TaskListSidebar",components:{OptionsPanel:qe,TaskFavoriteButton:We},props:{tasks:Array,filteredTasks:Array,categories:Array},data(){return{viewOptions:Pe,selectedItem:null,detailItem:null,comments:null}},methods:{useFormatDateTime:Ge,useAuthorAvatarURL:Qe,useAuthorShortName:Ye,isTaskListItemActive(e){return this.selectedItem&&this.selectedItem.id===e.id},isTaskListItemBgSuccessClass(e){return!this.isTaskListItemActive(e)&&!e.is_acquainted},markdownToHtml(e){return lo.sanitize((0,ao.TU)(e))},sanitize(e){return lo.sanitize(e)},fetchSelectedTask(){const e=`/journal/tasks/api/v1/task/${this.selectedItem.id}/`;return window.axios.get(e,{}).then((e=>(this.detailItem=e.data,e.data))).catch((function(e){throw console.log("Axios.get error:",e),e}))},fetchSelectedTaskComments(){const e="/journal/tasks/api/v1/comment_list/";return window.axios.get(e,{params:{taskId:this.selectedItem.id}}).then((e=>(this.comments=e.data,e.data))).catch((function(e){throw console.log("Axios.get error:",e),e}))}},watch:{selectedItem:{handler(){this.fetchSelectedTask(),this.fetchSelectedTaskComments()}}},mounted(){this.selectedItem||this.tasks.length&&(this.selectedItem=this.tasks[0])}};const co=(0,Le.Z)(so,[["render",oo],["__scopeId","data-v-0af180cc"]]);var no=co,io={name:"App",components:{TaskListTable:ot,TaskListSidebar:no},data(){return{fetchOptions:Fe,taskFilters:Me,viewOptions:Pe,tasksAll:[],categoriesAll:[],polling:null}},computed:{filteredTasks(){let e=this.tasksAll;return Me.showCompleted||(e=e.filter((e=>!e.is_completed))),Me.showActive||(e=e.filter((e=>e.is_completed))),Me.showFavoritesOnly&&(e=e.filter((e=>e.is_favorite))),Me.showPrivate||(e=e.filter((e=>!e.is_private))),e=e.filter((e=>Pe.categoriesVisibleIds.includes(e.category))),e}},watch:{fetchOptions:{handler(e){localStorage.setItem("fetchOptions",JSON.stringify(e)),this.fetchAllTasks()},deep:!0},viewOptions:{handler(e){localStorage.setItem("viewOptions",JSON.stringify(e))},deep:!0},taskFilters:{handler(e){localStorage.setItem("taskFilters",JSON.stringify(e))},deep:!0}},methods:{fetchAllCategories(){const e=window.location.origin+"/journal/tasks/api/v1/category_list/";return window.axios.get(e,{params:{}}).then((e=>{this.categoriesAll=e.data;let t=JSON.parse(localStorage.getItem("viewOptions"));return t&&Pe.set(t),null===Pe.categoriesVisibleIds&&Pe.copyAllCategoryIdsToVisible(this.categoriesAll),e.data})).catch((function(e){throw console.log("Axios.get error:",e),e}))},fetchAllTasks(){const e=window.location.origin+"/journal/tasks/api/v1/task_list/";let t={orderByFields:Fe.orderByFields.toString()};return window.axios.get(e,{params:t}).then((e=>(this.tasksAll=e.data,e.data))).catch((function(e){throw console.log("Axios.get error:",e),e}))},pollData(){this.polling=setInterval((()=>{Fe.autoUpdate&&this.fetchAllTasks()}),Fe.pollDataTimeout)}},created(){this.fetchAllCategories(),this.fetchAllTasks(),this.pollData()},beforeUnmount(){clearInterval(this.polling)},mounted(){let e=JSON.parse(localStorage.getItem("fetchOptions"));e&&Fe.set(e);let t=JSON.parse(localStorage.getItem("taskFilters"));t&&Me.set(t)}};const ro=(0,Le.Z)(io,[["render",k]]);var mo=ro;window.axios=o(7218),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";let po=document.getElementsByName("csrfmiddlewaretoken");po?window.axios.defaults.headers.common["X-CSRFToken"]=po[0].value:console.error("CSRF token not found: https://docs.djangoproject.com/en/3.0/ref/csrf/#ajax"),(0,a.createApp)(mo).mount("#dashboard-page-content")}},t={};function o(a){var l=t[a];if(void 0!==l)return l.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,a,l,s){if(!a){var c=1/0;for(d=0;d<e.length;d++){a=e[d][0],l=e[d][1],s=e[d][2];for(var n=!0,i=0;i<a.length;i++)(!1&s||c>=s)&&Object.keys(o.O).every((function(e){return o.O[e](a[i])}))?a.splice(i--,1):(n=!1,s<c&&(c=s));if(n){e.splice(d--,1);var r=l();void 0!==r&&(t=r)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[a,l,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var l,s,c=a[0],n=a[1],i=a[2],r=0;if(c.some((function(t){return 0!==e[t]}))){for(l in n)o.o(n,l)&&(o.m[l]=n[l]);if(i)var d=i(o)}for(t&&t(a);r<c.length;r++)s=c[r],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(d)},a=self["webpackChunkvue_tasks_table_view"]=self["webpackChunkvue_tasks_table_view"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[998],(function(){return o(2727)}));a=o.O(a)})();
//# sourceMappingURL=app.js.map