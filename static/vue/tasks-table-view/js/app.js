(function(){"use strict";var e={4739:function(e,t,o){var l=o(9199);const s={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-baseline pt-3 pb-2 mb-3 border-bottom"},a=(0,l.createElementVNode)("h1",{class:"h2"}," Задачи: табличный вид (Vue) ",-1),i={class:"btn-toolbar mb-2 mb-md-0"},n=(0,l.createElementVNode)("i",{class:"fa-solid fa-columns"},null,-1),c=(0,l.createElementVNode)("i",{class:"fa-solid fa-table"},null,-1),r=(0,l.createElementVNode)("i",{class:"fa-solid fa-gears"},null,-1),d=(0,l.createElementVNode)("a",{class:"btn btn-sm btn-success",href:"/journal/task/create/"},[(0,l.createElementVNode)("i",{class:"fa-solid fa-file-circle-plus"}),(0,l.createTextVNode)(" Добавить задачу ")],-1),m={key:0,class:"d-flex align-items-center"},p=(0,l.createElementVNode)("div",{class:"spinner-border text-primary me-3",role:"status"},[(0,l.createElementVNode)("span",{class:"visually-hidden"},"Loading...")],-1),h=(0,l.createElementVNode)("div",null," Идёт загрузка — пожалуйста, подождите! ",-1),u=[p,h];function k(e,t,o,p,h,k){const g=(0,l.resolveComponent)("TaskListTable"),b=(0,l.resolveComponent)("TaskListSidebar");return(0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createElementVNode)("div",s,[a,(0,l.createElementVNode)("div",i,[(0,l.createElementVNode)("button",{onClick:t[0]||(t[0]=e=>h.isTableView=!h.isTableView),class:"btn btn-sm btn-warning me-1"},[h.isTableView?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[n,(0,l.createTextVNode)(" Колонки ")],64)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[c,(0,l.createTextVNode)(" Таблица ")],64))]),(0,l.createElementVNode)("button",{class:"btn btn-sm btn-primary me-1",onClick:t[1]||(t[1]=e=>h.viewOptions.showOptions=!h.viewOptions.showOptions)},[r,(0,l.createTextVNode)(" Настройки ")]),d])]),h.tasksAll.length&&h.categoriesAll.length?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[h.isTableView?((0,l.openBlock)(),(0,l.createBlock)(g,{key:0,tasks:h.tasksAll,"filtered-tasks":k.filteredTasks,categories:h.categoriesAll,"categories-visible-ids":h.categoriesVisibleIds,"onUpdate:categoriesVisibleIds":t[2]||(t[2]=e=>h.categoriesVisibleIds=e),"view-options":h.viewOptions,"onUpdate:viewOptions":t[3]||(t[3]=e=>h.viewOptions=e),"tasks-filters":h.tasksFilters,"fetch-options":h.fetchOptions,"onUpdate:fetchOptions":t[4]||(t[4]=e=>h.fetchOptions=e),onOrderChanged:t[5]||(t[5]=e=>this.orderByFields=e)},null,8,["tasks","filtered-tasks","categories","categories-visible-ids","view-options","tasks-filters","fetch-options"])):((0,l.openBlock)(),(0,l.createBlock)(b,{key:1,tasks:h.tasksAll,"filtered-tasks":k.filteredTasks,categories:h.categoriesAll,"categories-visible-ids":h.categoriesVisibleIds,"onUpdate:categoriesVisibleIds":t[6]||(t[6]=e=>h.categoriesVisibleIds=e),"view-options":h.viewOptions,"onUpdate:viewOptions":t[7]||(t[7]=e=>h.viewOptions=e),"tasks-filters":h.tasksFilters,"fetch-options":h.fetchOptions,"onUpdate:fetchOptions":t[8]||(t[8]=e=>h.fetchOptions=e),onOrderChanged:t[9]||(t[9]=e=>this.orderByFields=e)},null,8,["tasks","filtered-tasks","categories","categories-visible-ids","view-options","tasks-filters","fetch-options"]))],64)):((0,l.openBlock)(),(0,l.createElementBlock)("div",m,u))],64)}o(7658);const g=e=>((0,l.pushScopeId)("data-v-129c13b1"),e=e(),(0,l.popScopeId)(),e),b={class:"alert alert-secondary"},f={class:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-baseline m-0"},V={class:"table-tasks-wrapper"},v={class:"table table-hover table-tasks text-nowrap"},w=g((()=>(0,l.createElementVNode)("th",{scope:"col",class:"text-center",style:{width:"30px"}},[(0,l.createElementVNode)("i",{class:"fa-regular fa-star"})],-1))),y=g((()=>(0,l.createElementVNode)("th",{scope:"col",class:"text-center",style:{width:"30px"}},[(0,l.createElementVNode)("i",{class:"fa-regular fa-lock"})],-1))),N=g((()=>(0,l.createElementVNode)("th",null," Задача ",-1))),E={key:0,class:"table-column-date text-center"},O={key:1,class:"table-column-date text-center"},C={class:"cell-favorite"},x={key:0,class:"fa-regular fa-star"},B={class:"text-muted"},S={key:0,class:"fa-regular fa-lock"},I={key:0,class:"task-completed-mark"},T=g((()=>(0,l.createElementVNode)("i",{class:"fa-solid fa-check"},null,-1))),F=[T],D=["href"],_={key:1,class:"text-muted category-title"},A=g((()=>(0,l.createElementVNode)("i",{class:"fa-solid fa-comments"},null,-1))),j={key:0},U={key:2,class:"ms-1"},M=["href"],L=g((()=>(0,l.createElementVNode)("i",{class:"fa-solid fa-paperclip"},null,-1))),P=[L],J={key:3,class:"text-muted category-title"},$=g((()=>(0,l.createElementVNode)("i",{class:"fa-solid fa-tag"},null,-1))),R={key:0,class:"table-column-date text-center"},Z={class:"text-muted category-title"},q={key:1,class:"table-column-date text-center"},H={class:"text-muted category-title"};function X(e,t,o,s,a,i){const n=(0,l.resolveComponent)("OptionsPanel");return(0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createElementVNode)("div",b,[(0,l.createElementVNode)("div",f,[(0,l.createElementVNode)("h4",null," Всего задач: "+(0,l.toDisplayString)(this.tasks.length)+", отображается: "+(0,l.toDisplayString)(o.filteredTasks.length)+". ",1)]),o.viewOptions.showOptions?((0,l.openBlock)(),(0,l.createBlock)(n,{key:0,categories:o.categories,"categories-visible-ids":o.categoriesVisibleIds,"onUpdate:categoriesVisibleIds":t[0]||(t[0]=e=>this.$emit("update:categoriesVisibleIds",e)),"view-options":o.viewOptions,"tasks-filters":o.tasksFilters,"fetch-options":o.fetchOptions,onOrderByFieldsChanged:t[1]||(t[1]=e=>this.$emit("orderChanged",e))},null,8,["categories","categories-visible-ids","view-options","tasks-filters","fetch-options"])):(0,l.createCommentVNode)("",!0)]),(0,l.createElementVNode)("div",V,[(0,l.createElementVNode)("table",v,[(0,l.createElementVNode)("thead",null,[(0,l.createElementVNode)("tr",null,[w,y,N,o.viewOptions.showCreatedDate?((0,l.openBlock)(),(0,l.createElementBlock)("th",E," Создана ")):(0,l.createCommentVNode)("",!0),o.viewOptions.showCompletedDate?((0,l.openBlock)(),(0,l.createElementBlock)("th",O," Завершена ")):(0,l.createCommentVNode)("",!0)])]),(0,l.createElementVNode)("tbody",null,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.filteredTasks,(e=>((0,l.openBlock)(),(0,l.createElementBlock)("tr",{key:e.id,class:(0,l.normalizeClass)(e.is_acquainted?"":"table-success")},[(0,l.createElementVNode)("td",C,[e.is_favorite?((0,l.openBlock)(),(0,l.createElementBlock)("i",x)):(0,l.createCommentVNode)("",!0)]),(0,l.createElementVNode)("td",B,[e.is_private?((0,l.openBlock)(),(0,l.createElementBlock)("i",S)):(0,l.createCommentVNode)("",!0)]),(0,l.createElementVNode)("td",null,[e.is_completed?((0,l.openBlock)(),(0,l.createElementBlock)("span",I,F)):(0,l.createCommentVNode)("",!0),(0,l.createElementVNode)("a",{href:`/journal/task/${e.id}/`,class:"task-title-link"},(0,l.toDisplayString)(e.title),9,D),o.viewOptions.showCommentsCount?((0,l.openBlock)(),(0,l.createElementBlock)("span",_,[A,(0,l.createTextVNode)(" "+(0,l.toDisplayString)(e.comments_count),1),e.new_comments_count?((0,l.openBlock)(),(0,l.createElementBlock)("span",j," · "+(0,l.toDisplayString)(e.new_comments_count),1)):(0,l.createCommentVNode)("",!0)])):(0,l.createCommentVNode)("",!0),e.attachment?((0,l.openBlock)(),(0,l.createElementBlock)("span",U,[(0,l.createElementVNode)("a",{href:e.attachment,class:"text-muted"},P,8,M)])):(0,l.createCommentVNode)("",!0),o.viewOptions.showCategory?((0,l.openBlock)(),(0,l.createElementBlock)("span",J,[$,(0,l.createTextVNode)(" "+(0,l.toDisplayString)(e.category_title),1)])):(0,l.createCommentVNode)("",!0)]),o.viewOptions.showCreatedDate?((0,l.openBlock)(),(0,l.createElementBlock)("td",R,[(0,l.createElementVNode)("span",Z,(0,l.toDisplayString)(i.useFormatDateTime(e.created)),1)])):(0,l.createCommentVNode)("",!0),o.viewOptions.showCompletedDate?((0,l.openBlock)(),(0,l.createElementBlock)("td",q,[(0,l.createElementVNode)("span",H,(0,l.toDisplayString)(e.is_completed?i.useFormatDateTime(e.completed):""),1)])):(0,l.createCommentVNode)("",!0)],2)))),128))])])])],64)}const z=e=>((0,l.pushScopeId)("data-v-cdc5e3fe"),e=e(),(0,l.popScopeId)(),e),K={class:"row mb-3 border-top pt-3 mt-3"},W={class:"col-6 col-lg-2"},G=z((()=>(0,l.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Фильтры",-1))),Q=z((()=>(0,l.createElementVNode)("label",{for:"check-show-active",class:"options-checkbox-label"},"В работе",-1))),Y=z((()=>(0,l.createElementVNode)("br",null,null,-1))),ee=z((()=>(0,l.createElementVNode)("label",{for:"check-show-private",class:"options-checkbox-label"},"Личные",-1))),te=z((()=>(0,l.createElementVNode)("br",null,null,-1))),oe=z((()=>(0,l.createElementVNode)("label",{for:"check-show-completed",class:"options-checkbox-label"},"Завершенные",-1))),le=z((()=>(0,l.createElementVNode)("br",null,null,-1))),se=z((()=>(0,l.createElementVNode)("label",{for:"check-show-favorite-only",class:"options-checkbox-label"},"Только избранные",-1))),ae=z((()=>(0,l.createElementVNode)("br",null,null,-1))),ie={class:"col-6 col-lg-2"},ne=z((()=>(0,l.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Упорядочить",-1))),ce={class:"col-6 col-lg-2"},re=z((()=>(0,l.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Отображение",-1))),de=z((()=>(0,l.createElementVNode)("label",{for:"check-auto-update",class:"options-checkbox-label"},"Автообновление",-1))),me=z((()=>(0,l.createElementVNode)("br",null,null,-1))),pe=z((()=>(0,l.createElementVNode)("label",{for:"check-show-category",class:"options-checkbox-label"},"Категории",-1))),he=z((()=>(0,l.createElementVNode)("br",null,null,-1))),ue=z((()=>(0,l.createElementVNode)("label",{for:"check-show-comments-count",class:"options-checkbox-label"},"Комментарии",-1))),ke=z((()=>(0,l.createElementVNode)("br",null,null,-1))),ge=z((()=>(0,l.createElementVNode)("label",{for:"check-show-created-date",class:"options-checkbox-label"},"Дата создания",-1))),be=z((()=>(0,l.createElementVNode)("br",null,null,-1))),fe=z((()=>(0,l.createElementVNode)("label",{for:"check-show-completed-date",class:"options-checkbox-label"},"Дата завершения",-1))),Ve=z((()=>(0,l.createElementVNode)("br",null,null,-1))),ve={class:"col-6 col-lg-6"},we=z((()=>(0,l.createElementVNode)("h5",{class:"options-title mb-1 pb-1 border-bottom"},"Категории",-1))),ye=["id","value"],Ne=["for","onClick"],Ee=z((()=>(0,l.createElementVNode)("br",null,null,-1))),Oe=z((()=>(0,l.createElementVNode)("br",null,null,-1)));function Ce(e,t,o,s,a,i){const n=(0,l.resolveComponent)("OrderBySelector");return(0,l.openBlock)(),(0,l.createElementBlock)("div",K,[(0,l.createElementVNode)("div",W,[G,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>a.localTasksFilters.showActive=e),id:"check-show-active"},null,512),[[l.vModelCheckbox,a.localTasksFilters.showActive]]),(0,l.createTextVNode)(),Q,Y,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>a.localTasksFilters.showPrivate=e),id:"check-show-private"},null,512),[[l.vModelCheckbox,a.localTasksFilters.showPrivate]]),(0,l.createTextVNode)(),ee,te,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>a.localTasksFilters.showCompleted=e),id:"check-show-completed"},null,512),[[l.vModelCheckbox,a.localTasksFilters.showCompleted]]),(0,l.createTextVNode)(),oe,le,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>a.localTasksFilters.showFavoritesOnly=e),id:"check-show-favorite-only"},null,512),[[l.vModelCheckbox,a.localTasksFilters.showFavoritesOnly]]),(0,l.createTextVNode)(),se,ae]),(0,l.createElementVNode)("div",ie,[ne,(0,l.createVNode)(n,{onOrderChanged:t[4]||(t[4]=e=>this.$emit("orderByFieldsChanged",e))})]),(0,l.createElementVNode)("div",ce,[re,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=e=>a.localFetchOptions.autoUpdate=e),id:"check-auto-update"},null,512),[[l.vModelCheckbox,a.localFetchOptions.autoUpdate]]),(0,l.createTextVNode)(),de,me,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>a.localViewOptions.showCategory=e),id:"check-show-category"},null,512),[[l.vModelCheckbox,a.localViewOptions.showCategory]]),(0,l.createTextVNode)(),pe,he,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>a.localViewOptions.showCommentsCount=e),id:"check-show-comments-count"},null,512),[[l.vModelCheckbox,a.localViewOptions.showCommentsCount]]),(0,l.createTextVNode)(),ue,ke,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>a.localViewOptions.showCreatedDate=e),id:"check-show-created-date"},null,512),[[l.vModelCheckbox,a.localViewOptions.showCreatedDate]]),(0,l.createTextVNode)(),ge,be,(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>a.localViewOptions.showCompletedDate=e),id:"check-show-completed-date"},null,512),[[l.vModelCheckbox,a.localViewOptions.showCompletedDate]]),(0,l.createTextVNode)(),fe,Ve]),(0,l.createElementVNode)("div",ve,[we,((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(this.categories,(e=>((0,l.openBlock)(),(0,l.createElementBlock)("span",{key:e.id,class:"category-checkbox-block"},[(0,l.withDirectives)((0,l.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=e=>a.localCategoriesVisibleIds=e),id:"category"+e.id,value:e.id},null,8,ye),[[l.vModelCheckbox,a.localCategoriesVisibleIds]]),(0,l.createTextVNode)(),(0,l.createElementVNode)("label",{for:"category"+e.id,class:"options-checkbox-label",onClick:(0,l.withModifiers)((t=>a.localCategoriesVisibleIds=[e.id]),["alt","prevent"])},(0,l.toDisplayString)(e.title),9,Ne),Ee])))),128)),(0,l.createElementVNode)("button",{onClick:t[11]||(t[11]=e=>a.localCategoriesVisibleIds=[]),class:"btn btn-sm btn-primary me-1 mt-2"},"Убрать все"),(0,l.createElementVNode)("button",{onClick:t[12]||(t[12]=(...e)=>i.copyAllCategoryIdsToVisible&&i.copyAllCategoryIdsToVisible(...e)),class:"btn btn-sm btn-primary mt-2"},"Показать все"),Oe])])}const xe=e=>((0,l.pushScopeId)("data-v-3a429529"),e=e(),(0,l.popScopeId)(),e),Be=xe((()=>(0,l.createElementVNode)("h6",{class:"options-title"},"Сортировать по:",-1))),Se={class:"drop-item"},Ie=["onClick"],Te=xe((()=>(0,l.createElementVNode)("h6",{class:"options-title"},"Доступные поля:",-1))),Fe={class:"drop-item"};function De(e,t,o,s,a,i){const n=(0,l.resolveComponent)("draggable");return(0,l.openBlock)(),(0,l.createElementBlock)("div",null,[(0,l.createElementVNode)("div",null,[Be,(0,l.createVNode)(n,{list:a.fieldsSelected,itemKey:"id",group:"fields",class:"drop-area"},{item:(0,l.withCtx)((({element:e})=>[(0,l.createElementVNode)("div",Se,[(0,l.createTextVNode)((0,l.toDisplayString)(e.name)+" ",1),(0,l.createElementVNode)("button",{class:"button-ascending",onClick:t=>e.ascending=!e.ascending},(0,l.toDisplayString)(e.ascending?"▲":"▼"),9,Ie)])])),_:1},8,["list"])]),(0,l.createElementVNode)("div",null,[Te,(0,l.createVNode)(n,{list:a.fieldsAvailable,itemKey:"id",group:"fields",class:"drop-area"},{item:(0,l.withCtx)((({element:e})=>[(0,l.createElementVNode)("div",Fe,(0,l.toDisplayString)(e.name),1)])),_:1},8,["list"])])])}var _e=o(6983),Ae=o.n(_e),je={components:{draggable:Ae()},props:{orderBy:Array},emits:["orderChanged"],data(){return{fieldsSelected:[{name:"Новое",id:1,sortField:"is_acquainted",ascending:!0},{name:"Избранное",id:2,sortField:"is_favorite",ascending:!1},{name:"В работе",id:3,sortField:"is_completed",ascending:!0},{name:"Дата завершения",id:4,sortField:"completed",ascending:!1}],fieldsAvailable:[{name:"Дата создания",id:5,sortField:"created",ascending:!0},{name:"Личное",id:6,sortField:"is_private",ascending:!0}]}},watch:{fieldsSelected:{handler(e){localStorage.setItem("fieldsSelected",JSON.stringify(e)),this.$emit("orderChanged",this.orderByFields)},deep:!0},fieldsAvailable:{handler(e){localStorage.setItem("fieldsAvailable",JSON.stringify(e))},deep:!0}},computed:{orderByFields(){let e=[];return this.fieldsSelected.forEach((t=>{e.push(t.ascending?t.sortField:"-"+t.sortField)})),e}},mounted(){let e=JSON.parse(localStorage.getItem("fieldsSelected"));e&&(this.fieldsSelected=e);let t=JSON.parse(localStorage.getItem("fieldsAvailable"));t&&(this.fieldsAvailable=t)}},Ue=o(89);const Me=(0,Ue.Z)(je,[["render",De],["__scopeId","data-v-3a429529"]]);var Le=Me,Pe={name:"OptionsPanel",components:{OrderBySelector:Le},props:{categories:Array,categoriesVisibleIds:Array,viewOptions:Object,fetchOptions:Object,tasksFilters:Object},emits:["update:categoriesVisibleIds","update:viewOptions","update:fetchOptions","update:tasksFilters","orderByFieldsChanged"],data(){return{localCategoriesVisibleIds:this.categoriesVisibleIds,localViewOptions:this.viewOptions,localFetchOptions:this.fetchOptions,localTasksFilters:this.tasksFilters}},watch:{localCategoriesVisibleIds:{handler(e){this.$emit("update:categoriesVisibleIds",e)},deep:!0},localTasksFilters:{handler(e){this.$emit("update:tasksFilters",e)},deep:!0},localViewOptions:{handler(e){this.$emit("update:viewOptions",e)},deep:!0}},methods:{copyAllCategoryIdsToVisible(){this.localCategoriesVisibleIds=[];for(let e=0;e<this.categories.length;e++)this.localCategoriesVisibleIds.push(this.categories[e].id)}}};const Je=(0,Ue.Z)(Pe,[["render",Ce],["__scopeId","data-v-cdc5e3fe"]]);var $e=Je;function Re(e){let t=new Date(e);return t.toLocaleDateString("ru-RU")+" "+t.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}var Ze={name:"TaskListTable",components:{OptionsPanel:$e},props:{tasks:Array,filteredTasks:Array,categories:Array,categoriesVisibleIds:Array,fetchOptions:Object,viewOptions:Object,tasksFilters:Object},emits:["orderChanged","update:categoriesVisibleIds"],methods:{useFormatDateTime:Re}};const qe=(0,Ue.Z)(Ze,[["render",X],["__scopeId","data-v-129c13b1"]]);var He=qe;const Xe=e=>((0,l.pushScopeId)("data-v-26707f38"),e=e(),(0,l.popScopeId)(),e),ze={class:"component"},Ke={class:"tasks"},We={class:"d-flex align-items-center flex-shrink-0 p-3 link-dark text-decoration-none border-bottom"},Ge={class:"",style:{"flex-grow":"1"}},Qe={class:"task-list list-group list-group-flush"},Ye=["onClick"],et={class:"d-flex w-100 align-items-center justify-content-between"},tt={class:"mb-1"},ot={key:0,class:"fa-regular fa-star"},lt={key:1,class:"fa-regular fa-lock"},st={class:"col-10 mb-1 small"},at={key:0,class:"alert alert-secondary"},it={key:1,class:"task-detail"},nt={class:"m-2"},ct=["innerHTML"],rt=Xe((()=>(0,l.createElementVNode)("h4",null," Комментарии ",-1))),dt={key:0},mt=Xe((()=>(0,l.createElementVNode)("br",null,null,-1))),pt={key:1};function ht(e,t,o,s,a,i){const n=(0,l.resolveComponent)("OptionsPanel");return(0,l.openBlock)(),(0,l.createElementBlock)("div",ze,[(0,l.createElementVNode)("div",Ke,[(0,l.createElementVNode)("div",We,[(0,l.createElementVNode)("div",Ge," Задач: "+(0,l.toDisplayString)(o.filteredTasks.length)+" / "+(0,l.toDisplayString)(o.tasks.length),1)]),(0,l.createElementVNode)("div",Qe,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(this.filteredTasks,(e=>((0,l.openBlock)(),(0,l.createElementBlock)("a",{key:e.id,href:"#",onClick:t=>this.selectedItem=e,class:(0,l.normalizeClass)(["task-list-item list-group-item list-group-item-action py-3 lh-sm",{active:a.selectedItem&&a.selectedItem.id===e.id}])},[(0,l.createElementVNode)("div",et,[(0,l.createElementVNode)("strong",tt,(0,l.toDisplayString)(e.title),1),e.is_favorite?((0,l.openBlock)(),(0,l.createElementBlock)("i",ot)):(0,l.createCommentVNode)("",!0),e.is_private?((0,l.openBlock)(),(0,l.createElementBlock)("i",lt)):(0,l.createCommentVNode)("",!0)]),(0,l.createElementVNode)("div",st,(0,l.toDisplayString)(e.category_title),1)],10,Ye)))),128))])]),o.viewOptions.showOptions?((0,l.openBlock)(),(0,l.createElementBlock)("div",at,[(0,l.createVNode)(n,{categories:o.categories,"categories-visible-ids":o.categoriesVisibleIds,"onUpdate:categoriesVisibleIds":t[0]||(t[0]=e=>this.$emit("update:categoriesVisibleIds",e)),"view-options":o.viewOptions,"tasks-filters":o.tasksFilters,"fetch-options":o.fetchOptions,onOrderByFieldsChanged:t[1]||(t[1]=e=>this.$emit("orderChanged",e))},null,8,["categories","categories-visible-ids","view-options","tasks-filters","fetch-options"])])):((0,l.openBlock)(),(0,l.createElementBlock)("div",it,[a.selectedItem?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[a.detailItem?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[(0,l.createElementVNode)("h3",null,(0,l.toDisplayString)(a.detailItem.title),1),(0,l.createElementVNode)("div",nt,[(0,l.createElementVNode)("p",null," Автор: "+(0,l.toDisplayString)(a.detailItem.author_last_name)+" "+(0,l.toDisplayString)(a.detailItem.author_first_name)+" "+(0,l.toDisplayString)(a.detailItem.author_second_name)+", "+(0,l.toDisplayString)(i.useFormatDateTime(a.detailItem.created)),1),(0,l.createElementVNode)("span",{innerHTML:a.detailItem.body},null,8,ct)]),rt,a.comments?((0,l.openBlock)(),(0,l.createElementBlock)("ul",dt,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(a.comments,(e=>((0,l.openBlock)(),(0,l.createElementBlock)("li",{key:e.id},[(0,l.createTextVNode)((0,l.toDisplayString)(e.author_last_name)+" "+(0,l.toDisplayString)(e.author_first_name)+" "+(0,l.toDisplayString)(e.author_second_name)+" · "+(0,l.toDisplayString)(i.useFormatDateTime(e.created)),1),mt,(0,l.createTextVNode)(" "+(0,l.toDisplayString)(e.body),1)])))),128))])):(0,l.createCommentVNode)("",!0)],64)):(0,l.createCommentVNode)("",!0)],64)):((0,l.openBlock)(),(0,l.createElementBlock)("span",pt," Выберите задачу слева "))]))])}var ut={name:"TaskListSidebar",components:{OptionsPanel:$e},props:{tasks:Array,filteredTasks:Array,categories:Array,categoriesVisibleIds:Array,fetchOptions:Object,viewOptions:Object,tasksFilters:Object},emits:["orderChanged","update:categoriesVisibleIds"],data(){return{selectedItem:null,detailItem:null,comments:null}},methods:{useFormatDateTime:Re,fetchSelectedTask(){const e=`/journal/tasks/api/v1/task/${this.selectedItem.id}/`;return window.axios.get(e,{}).then((e=>(this.detailItem=e.data,e.data))).catch((function(e){throw console.log("Axios.get error:",e),e}))},fetchSelectedTaskComments(){const e="/journal/tasks/api/v1/comment_list/";return window.axios.get(e,{params:{taskId:this.selectedItem.id}}).then((e=>(this.comments=e.data,e.data))).catch((function(e){throw console.log("Axios.get error:",e),e}))}},watch:{selectedItem:{handler(){this.fetchSelectedTask(),this.fetchSelectedTaskComments()}}}};const kt=(0,Ue.Z)(ut,[["render",ht],["__scopeId","data-v-26707f38"]]);var gt=kt,bt={name:"App",components:{TaskListTable:He,TaskListSidebar:gt},data(){return{tasksAll:[],categoriesAll:[],categoriesVisibleIds:[],isTableView:!0,orderByFields:[],fetchOptions:{autoUpdate:!0,pollDataTimeout:5e3},polling:null,tasksFilters:{showActive:!0,showCompleted:!1,showPrivate:!0,showFavoritesOnly:!1},viewOptions:{showOptions:!0,showCategory:!1,showCommentsCount:!0,showCreatedDate:!1,showCompletedDate:!1}}},computed:{filteredTasks(){let e=this.tasksAll;return this.tasksFilters.showCompleted||(e=e.filter((e=>!e.is_completed))),this.tasksFilters.showActive||(e=e.filter((e=>e.is_completed))),this.tasksFilters.showFavoritesOnly&&(e=e.filter((e=>e.is_favorite))),this.tasksFilters.showPrivate||(e=e.filter((e=>!e.is_private))),e=e.filter((e=>this.categoriesVisibleIds.includes(e.category))),e}},watch:{fetchOptions:{handler(e){localStorage.setItem("fetchOptions",JSON.stringify(e))},deep:!0},orderByFields:{handler(){this.fetchAllTasks()},deep:!0},categoriesVisibleIds:{handler(e){localStorage.setItem("categoriesVisibleIds",JSON.stringify(e))},deep:!0},viewOptions:{handler(e){localStorage.setItem("viewOptions",JSON.stringify(e))},deep:!0},tasksFilters:{handler(e){localStorage.setItem("tasksFilters",JSON.stringify(e))},deep:!0}},methods:{fetchAllCategories(){const e=window.location.origin+"/journal/tasks/api/v1/category_list/";return window.axios.get(e,{params:{}}).then((e=>{this.categoriesAll=e.data;let t=localStorage.getItem("categoriesVisibleIds");if(null==t)for(let o=0;o<this.categoriesAll.length;o++)this.categoriesVisibleIds.push(this.categoriesAll[o].id);else this.categoriesVisibleIds=JSON.parse(t);return e.data})).catch((function(e){throw console.log("Axios.get error:",e),e}))},fetchAllTasks(){const e=window.location.origin+"/journal/tasks/api/v1/task_list/";let t={orderByFields:this.orderByFields.toString()};return window.axios.get(e,{params:t}).then((e=>(this.tasksAll=e.data,e.data))).catch((function(e){throw console.log("Axios.get error:",e),e}))},pollData(){this.polling=setInterval((()=>{this.fetchOptions.autoUpdate&&this.fetchAllTasks()}),this.fetchOptions.pollDataTimeout)}},created(){this.fetchAllCategories(),this.fetchAllTasks(),this.pollData()},beforeUnmount(){clearInterval(this.polling)},mounted(){let e=JSON.parse(localStorage.getItem("fetchOptions"));e&&(this.fetchOptions=e);let t=JSON.parse(localStorage.getItem("viewOptions"));t&&(this.viewOptions=t);let o=JSON.parse(localStorage.getItem("tasksFilters"));o&&(this.tasksFilters=o)}};const ft=(0,Ue.Z)(bt,[["render",k]]);var Vt=ft;window.axios=o(7218),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";let vt=document.getElementsByName("csrfmiddlewaretoken");vt?window.axios.defaults.headers.common["X-CSRFToken"]=vt[0].value:console.error("CSRF token not found: https://docs.djangoproject.com/en/3.0/ref/csrf/#ajax"),(0,l.createApp)(Vt).mount("#dashboard-page-content")}},t={};function o(l){var s=t[l];if(void 0!==s)return s.exports;var a=t[l]={exports:{}};return e[l].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,l,s,a){if(!l){var i=1/0;for(d=0;d<e.length;d++){l=e[d][0],s=e[d][1],a=e[d][2];for(var n=!0,c=0;c<l.length;c++)(!1&a||i>=a)&&Object.keys(o.O).every((function(e){return o.O[e](l[c])}))?l.splice(c--,1):(n=!1,a<i&&(i=a));if(n){e.splice(d--,1);var r=s();void 0!==r&&(t=r)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[l,s,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,l){var s,a,i=l[0],n=l[1],c=l[2],r=0;if(i.some((function(t){return 0!==e[t]}))){for(s in n)o.o(n,s)&&(o.m[s]=n[s]);if(c)var d=c(o)}for(t&&t(l);r<i.length;r++)a=i[r],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(d)},l=self["webpackChunkvue_tasks_table_view"]=self["webpackChunkvue_tasks_table_view"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=o.O(void 0,[998],(function(){return o(4739)}));l=o.O(l)})();
//# sourceMappingURL=app.js.map